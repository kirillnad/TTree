# Руководство пользователя

## Загрузка файлов
- Изображения: `image/*` (JPEG, PNG, GIF, WebP и т.п.).
- Документы: `pdf`, `doc`, `docx`, `xls`, `xlsx`, `ppt`, `pptx`.
- Текстовые: `txt`, `csv`, `rtf`.

Файлы сохраняются по пути `/uploads/{articleId}/uuid.ext`. Для изображений создаются уменьшенные копии; исходник не сохраняется.

## Горячие клавиши

### Режим просмотра (view)
- `Enter` — начать редактирование выбранного блока.
- `Ctrl+Z` / `Ctrl+Y` — откат / повтор.
- `Ctrl+Shift+ArrowDown` / `Ctrl+Shift+ArrowUp` — переместить блок вниз/вверх.
- `Ctrl+ArrowDown` / `Ctrl+ArrowUp` — создать блок после/до текущего.
- `Ctrl+Delete` — удалить блок.
- `Ctrl+ArrowRight` / `Ctrl+ArrowLeft` — вложить / вынуть блок из вложенности.
- `ArrowDown` / `ArrowUp` — выбрать следующий/предыдущий видимый блок.
- `ArrowRight` — раскрыть выбранный или перейти к дочернему.
- `ArrowLeft` — свернуть выбранный или перейти к родителю.

### Режим редактирования (edit)
- `Ctrl+Enter` — сохранить и выйти из редактирования.
- `Ctrl+ArrowRight` / `Ctrl+ArrowLeft` — вложить / вынуть текущий блок, оставаясь в редактировании.
- `Ctrl+ArrowDown` — разрезать блок по курсору (вторая часть станет новым блоком).
- `Ctrl+ArrowUp` — сохранить и создать блок выше.
- `Esc` — отменить редактирование.
- Пустой блок при выходе из редактирования (Esc, Cancel) или при сохранении удаляется автоматически.
- В режиме редактирования слева на месте кнопки сворачивания появляется кнопка `✕` (отмена изменений), а справа на месте кнопки добавления — `✔` (сохранение блока).

### Модальные окна/формы
- `Enter` — подтвердить.
- `Esc` — закрыть.

## Перетаскивание блоков (Drag & Drop)
- Включи режим перетаскивания кнопкой «⇅ Перетаскивание» в шапке статьи. Включённый режим действует только в режиме просмотра и только для обычных статей (не inbox).
- Включённый режим: тяни за любой участок блока (его поверхность), кроме интерактивных элементов (кнопки, поля ввода, ссылки и т.п.).
- Выключенный режим: блоки мышью не перетаскиваются, работают только горячие клавиши перемещения.
- Зона дропа: верх блока — вставить перед ним, низ — после, середина — вложить внутрь как последнего потомка.
- Запрещено переносить блок в самого себя или своих потомков; такие цели не подсвечиваются.
- Undo/Redo работают и для DnD: `Ctrl+Z` / `Ctrl+Y` откатывают/повторяют последнее перемещение.

## Быстрое добавление блока
- У выбранного блока справа отображается круглая кнопка с иконкой `+` — она добавляет новый блок **на том же уровне сразу под текущим** и сразу переводит его в режим редактирования.

## Меню форматирования (rich-context)
- В режиме редактирования клик по любому месту текста блока открывает всплывающее меню форматирования.
- В левом столбце «Буфер» находятся иконки:
  - `⧉` — копировать выделенный фрагмент в буфер приложения и в стандартный буфер обмена;
  - `✂` — вырезать выделенный фрагмент (с сохранением в оба буфера);
  - `▣` — вставить содержимое внутреннего буфера в текущую позицию курсора;
  - `⛶` — выделить весь текст текущего блока.
- Вставка через кнопку «▣» использует только внутренний буфер редактора — вставить можно именно тот текст, который был скопирован/вырезан в этом же редакторе.
